<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <title>Insta BOT For Ana</title>
  <style media="screen">
    body {
        margin: 0 auto;
        padding-top: 16px;
        padding-bottom: 16px;
      }
    </style>
</head>

<body>
  <div class="container">
    <div class="row">
      <div class="col col-sm-4 hashtags">
        <h2>Hashtags</h2>
        <div class="long-array" style="">
          <table class="table table-striped">
            <tbody>
              {{ range .Hashtags }}
              <tr class="">
                <td>
                  #{{.}}
                </td>
              </tr>
              {{end}}
            </tbody>
          </table>
        </div>
      </div>
      <div class="col col-sm-8 settings">
        <h2>Settings</h2>
        <form action="save" method="post">
          <div class="form-group">
            <label for="exampleInputEmail1"><strong>Username</strong></label>
            <input name="username" type="text" class="form-control" id="exampleInputEmail1" placeholder="Enter email" value="{{.Username}}">
          </div>
          <div class="form-group">
            <label for="exampleInputPassword1"><strong>Password</strong></label>
            <input name="password" type="password" class="form-control" id="exampleInputPassword1" placeholder="Password" value="{{.Password}}">
          </div>
          <div class="form-group">
            <label for="exampleFormControlInput1"><strong>Total likes</strong></label>
            <div class="alert alert-primary" style="font-size: 14px; line-height: 15px">The <strong>Total Likes</strong> specifies how many total likes you want to perform</div>
            <input type="number" name="total_likes" class="form-control" id="exampleFormControlInput1" value="{{.TotalLikes}}">
          </div>
          <div class="form-group">
            <label for="exampleFormControlInput1"><strong>Per user</strong></label>
            <input type="number" name="per_user" class="form-control" id="exampleFormControlInput1" value="{{.PerUser}}">
          </div>
          <div class="form-row">
            <div class="form-group col">
              <label for="exampleFormControlInput1"><strong>Min Followers</strong></label>
              <input type="number" name="min_followers" class="form-control" id="exampleFormControlInput1" value="{{.MinFollowers}}">
            </div>
            <div class="form-group col">
              <label for="exampleFormControlInput1"><strong>Max Followers</strong></label>
              <input type="number" name="max_followers" class="form-control" id="exampleFormControlInput1" value="{{.MaxFollowers}}">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col">
              <label for="exampleFormControlInput1"><strong>Min Following</strong></label>
              <input type="number" name="min_following" class="form-control" id="exampleFormControlInput1" value="{{.MinFollowing}}">
            </div>
            <div class="form-group col">
              <label for="exampleFormControlInput1"><strong>Max Following</strong></label>
              <input type="number" name="max_following" class="form-control" id="exampleFormControlInput1" value="{{.MaxFollowing}}">
            </div>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">
              <strong>Preference</strong>
            </label>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="potency" id="potency_negative" value="negative" checked>
              <label class="form-check-label" for="potency_negative">
                More following than followers
              </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="potency" id="potency_positive" value="positive">
              <label class="form-check-label" for="potency_positive">
                More followers than following
              </label>
            </div>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Hashtags</label>
            <textarea class="form-control" name="hashtags" id="exampleFormControlTextarea1" rows="20">{{.HastagStr}}</textarea>
          </div>
          <button class="btn btn-primary" type="save" name="button">Save!</button>
        </form>
        <div class="container row" style="padding-top: 10px;">
          Status:   <strong id="status">Unavailable</strong>
        </div>
        <div class="container row" style="padding-top: 10px;">
          <div class="col-xs-4">
            <form class="form-group" action="run" method="post" id="startForm">
              <button class="btn btn-primary" type="submit" name="button" id="startButton">Start!</button>
            </form>
          </div>
          <div class="col-xs-2" style="width: 10px">
            <div class="" style="width:100%">

            </div>
          </div>
          <div class="col-xs-4">
            <form class="form-group" action="stop" method="post" id="stopForm">
              <button class="btn btn-primary" type="submit" name="button">STOP!</button>
            </form>
          </div>
        </div>
        <div class="container row" style="padding-top: 10px; max-height: 400px;" id="output">
        </div>

      </div>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script type="text/javascript">
    console.log("ws://" + window.location.hostname + ":8080/ws");
    var ws = new WebSocket("ws://" + window.location.hostname + ":8080/ws");

    function changeStatus(running) {
      var disabled = 'disabled';
      var startButton = '#startButton'
      if (running) {
        console.log('Is running!');
        $(startButton).attr(disabled, "true");
      } else {
        console.log('Is not running!');
        $(startButton).removeAttr(disabled);
      }
    }

    ws.onmessage = function (event) {
      var d = JSON.parse(event.data);
      console.log(d);
      changeStatus(d.running)
      $('#stopForm').attr('action', 'stop?conId=' + d.id)
      $('#startForm').attr('action', 'run?conId=' + d.id)
      $('#status').text(d.running ? 'Running' : 'Not running');
      $('#output').html(d.output);
    }
    ws.onerror = function (event) {
      console.log(event);
      $('#status').text('Unavailable')
    }
    ws.onclose = function (event) {
      console.log(event);
      $('#status').text('Unavailable')
    }
  </script>
</body>

</html>
